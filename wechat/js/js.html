<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>JS解析</title>
  <style>
      *{box-sizing: border-box;padding: 0;}
      body{margin:20px auto;width: 1200px;}
    </style>
</head>
<body>
  <h3>JS逻辑交互</h3>
  <pre>
    &lt;view>{{ msg }}&lt;/view>
    &lt;button bindtap="clickMe">点击我&lt;/button>
  </pre>
  <pre>
    Page({
      clickMe: function() {
        this.setData({ msg: "Hello World" })
      }
    })
  </pre>
  
  <h3>事件分类</h3>
  <p>事件分为冒泡事件和非冒泡事件：</p>
  <ol>
    <li>冒泡事件：当一个组件上的事件被触发后，该事件会向父节点传递。</li>
    <li>非冒泡事件：当一个组件上的事件被触发后，该事件不会向父节点传递。</li>
  </ol>
  <p>WXML的冒泡事件列表：</p>
  <img src="../images/js/bubbling.png" alt="">
  <h3>事件绑定和冒泡</h3>
  <p>事件绑定的写法同组件的属性，以 key、value 的形式。</p>
  <ul>
    <li>key 以bind或catch开头，然后跟上事件的类型，如bindtap、catchtouchstart。自基础库版本 1.5.0 起，在非原生组件中，bind和catch后可以紧跟一个冒号，其含义不变，如bind:tap、catch:touchstart。</li>
    <li>value 是一个字符串，需要在对应的 Page 中定义同名的函数。不然当触发事件的时候会报错。</li>
  </ul>
  <p style="color:red;">bind事件绑定不会阻止冒泡事件向上冒泡，catch事件绑定可以阻止冒泡事件向上冒泡。</p>
  <p>事件冒泡的顺序为从内向外，事件捕获的顺序为从外到内</p>
  <img src="../images/js/catch.png" alt="">
  <img src="../images/js/catch2.png" alt="">
  <h3>事件对象</h3>
  <h4>BaseEvent 基础事件对象属性列表</h4>
  <img src="../images/js/event-object.png" alt="">
  <h4>CustomEvent 自定义事件对象属性列表（继承 BaseEvent）</h4>
  <img src="../images/js/custom-event.png" alt="">
  <h4>TouchEvent 触摸事件对象属性列表（继承 BaseEvent）</h4>
  <img src="../images/js/touch-event.png" alt="">
  <h4>type:代表事件的类型。</h4>
  <h4>timeStamp:页面打开到触发事件所经过的毫秒数。</h4>
  <h4>target:触发事件的源组件。</h4>
  <img src="../images/js/target.png" alt="">
  <h4>currentTarget:事件绑定的当前组件。</h4>
  <img src="../images/js/currentTarget.png" alt="">
  <h4>dataset</h4>
  <p>在 WXML 中，这些自定义数据以 data- 开头，多个单词由连字符 - 连接。这种写法中，连字符写法会转换成驼峰写法，而大写字符会自动转成小写字符。</p>
  <ul>
    <li>data-element-type ，最终会呈现为 event.currentTarget.dataset.elementType ；</li>
    <li>data-elementType ，最终会呈现为 event.currentTarget.dataset.elementtype 。</li>
  </ul>
  <h4>mark</h4>
  <p>当事件触发时，事件冒泡路径上所有的 mark 会被合并，并返回给事件回调函数。</p>
  <p>细节注意事项：</p>
  <ul>
    <li>如果存在同名的 mark ，父节点的 mark 会被子节点覆盖。</li>
    <li>在自定义组件中接收事件时， mark 不包含自定义组件外的节点的 mark 。</li>
    <li>不同于 dataset ，节点的 mark 不会做连字符和大小写转换。</li>
  </ul>
  <h4>touches</h4>
  <p>touches 是一个数组，每个元素为一个 Touch 对象（canvas 触摸事件中携带的 touches 是 CanvasTouch 数组）。 表示当前停留在屏幕上的触摸点。</p>
  <h5>Touch 对象</h5>
  <img src="../images/js/touch.png" alt="">
  <h4>CanvasTouch 对象</h5>
  <img src="../images/js/canvasTouch.png" alt="">
  <h4>changedTouches</h4>
  <p>changedTouches 数据格式同 touches。 表示有变化的触摸点，如从无变有（touchstart），位置变化（touchmove），从有变无（touchend、touchcancel）。</p>
  <h4>detail</h4>
  <p>自定义事件所携带的数据，如表单组件的提交事件会携带用户的输入，媒体的错误事件会携带错误信息，详见组件定义中各个事件的定义。点击事件的detail 带有的 x, y 同 pageX, pageY 代表距离文档左上角的距离</p>
</body>
</html>